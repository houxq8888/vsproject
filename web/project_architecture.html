<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vsproject é¡¹ç›®æŠ€æœ¯æ¶æ„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .architecture-overview {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .architecture-overview h2 {
            color: #4a5568;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }

        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .tech-item {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #667eea;
        }

        .tech-item h3 {
            color: #2d3748;
            margin-bottom: 10px;
        }

        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .module-category {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .module-category:hover {
            transform: translateY(-5px);
        }

        .module-category h3 {
            color: #2d3748;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .module-category h3::before {
            content: "ğŸ“¦";
            font-size: 1.5em;
        }

        .module-list {
            list-style: none;
        }

        .module-item {
            background: #f7fafc;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #48bb78;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .module-item:hover {
            background: #edf2f7;
            transform: translateX(5px);
        }

        .module-item h4 {
            color: #2d3748;
            margin-bottom: 5px;
        }

        .module-item p {
            color: #718096;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .module-details {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: none;
        }

        .module-details.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-btn {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .close-btn:hover {
            background: #c53030;
        }

        .details-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .dependencies, .features {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
        }

        .dependencies h4, .features h4 {
            color: #2d3748;
            margin-bottom: 15px;
        }

        .dependency-list, .feature-list {
            list-style: none;
        }

        .dependency-list li, .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .dependency-list li:last-child, .feature-list li:last-child {
            border-bottom: none;
        }

        .build-info {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .build-info h2 {
            color: #4a5568;
            margin-bottom: 20px;
        }

        .build-commands {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .command-item {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #ed8936;
        }

        .command-item h4 {
            color: #2d3748;
            margin-bottom: 10px;
        }

        .command-item code {
            background: #edf2f7;
            padding: 5px 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            color: #e53e3e;
        }

        @media (max-width: 768px) {
            .details-content {
                grid-template-columns: 1fr;
            }
            
            .modules-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }

        /* ç¼–è¯‘æ§åˆ¶æ ·å¼ */
        .compile-controls {
            margin-top: 20px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 10px;
            border-left: 4px solid #ed8936;
        }

        .compile-controls h4 {
            color: #2d3748;
            margin-bottom: 15px;
        }

        .compile-options {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .compile-options label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        .compile-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .compile-btn {
            background: #48bb78;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .compile-btn:hover:not(:disabled) {
            background: #38a169;
        }

        .compile-btn:disabled {
            background: #a0aec0;
            cursor: not-allowed;
        }

        .stop-btn {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .stop-btn:hover:not(:disabled) {
            background: #c53030;
        }

        .stop-btn:disabled {
            background: #a0aec0;
            cursor: not-allowed;
        }

        .compile-output {
            background: #1a202c;
            color: #cbd5e0;
            padding: 15px;
            border-radius: 5px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            line-height: 1.4;
        }

        .compile-output h5 {
            color: #e2e8f0;
            margin-bottom: 10px;
        }

        .compile-output pre {
            white-space: pre-wrap;
            word-break: break-all;
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>vsproject é¡¹ç›®æŠ€æœ¯æ¶æ„</h1>
            <p>åŸºäºC++/Qtçš„æ¨¡å—åŒ–è½¯ä»¶é¡¹ç›® - å®Œæ•´æŠ€æœ¯æ ˆå±•ç¤º</p>
        </div>

        <div class="architecture-overview">
            <h2>ğŸ“Š æŠ€æœ¯æ¶æ„æ¦‚è§ˆ</h2>
            <p>vsprojectæ˜¯ä¸€ä¸ªå¤§å‹çš„C++è½¯ä»¶é¡¹ç›®ï¼Œé‡‡ç”¨æ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼Œæ”¯æŒè·¨å¹³å°å¼€å‘ï¼ˆLinux/Windowsï¼‰ï¼Œä¸»è¦é¢å‘ç§‘å­¦ä»ªå™¨å’Œå·¥ä¸šè‡ªåŠ¨åŒ–é¢†åŸŸã€‚</p>
            
            <div class="tech-stack">
                <div class="tech-item">
                    <h3>ç¼–ç¨‹è¯­è¨€</h3>
                    <p>C++ 17/20</p>
                </div>
                <div class="tech-item">
                    <h3>GUIæ¡†æ¶</h3>
                    <p>Qt 5.14+</p>
                </div>
                <div class="tech-item">
                    <h3>æ„å»ºç³»ç»Ÿ</h3>
                    <p>CMake 3.22+</p>
                </div>
                <div class="tech-item">
                    <h3>å›¾åƒå¤„ç†</h3>
                    <p>OpenCV 4.6+</p>
                </div>
                <div class="tech-item">
                    <h3>ç½‘ç»œé€šä¿¡</h3>
                    <p>MQTT/WebSocket</p>
                </div>
                <div class="tech-item">
                    <h3>æ•°æ®åº“</h3>
                    <p>SQLCipher</p>
                </div>
            </div>
        </div>

        <div class="modules-grid">
            <!-- åº”ç”¨æ¨¡å— -->
            <div class="module-category">
                <h3>åº”ç”¨æ¨¡å— (Applications)</h3>
                <ul class="module-list">
                    <li class="module-item" onclick="showModuleDetails('hgdashboardapp')">
                        <h4>HGDashboardApp</h4>
                        <p>ä»ªè¡¨ç›˜åº”ç”¨ - æä¾›ç³»ç»Ÿç›‘æ§å’Œæ•°æ®å¯è§†åŒ–ç•Œé¢</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgcomdebugapp')">
                        <h4>HGComDebugApp</h4>
                        <p>é€šä¿¡è°ƒè¯•åº”ç”¨ - ç”¨äºç¡¬ä»¶é€šä¿¡è°ƒè¯•å’Œæµ‹è¯•</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgcupdetapp')">
                        <h4>HGCupDetApp</h4>
                        <p>æ¯æ£€æµ‹åº”ç”¨ - åŸºäºå›¾åƒè¯†åˆ«çš„æ ·å“æ¯æ£€æµ‹</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgonlineplatformapp')">
                        <h4>HGOnlinePlatformApp</h4>
                        <p>åœ¨çº¿å¹³å°åº”ç”¨ - äº‘ç«¯æ•°æ®åŒæ­¥å’Œè¿œç¨‹ç›‘æ§</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('productflow')">
                        <h4>ProductFlow</h4>
                        <p>äº§å“æµç¨‹åº”ç”¨ - ç”Ÿäº§æµç¨‹æ§åˆ¶å’Œä¼˜åŒ–</p>
                    </li>
                </ul>
            </div>

            <!-- æ ¸å¿ƒæ¨¡å— -->
            <div class="module-category">
                <h3>æ ¸å¿ƒæ¨¡å— (Core Modules)</h3>
                <ul class="module-list">
                    <li class="module-item" onclick="showModuleDetails('hgbaseappmodule')">
                        <h4>HGBaseAppModule</h4>
                        <p>åŸºç¡€åº”ç”¨æ¨¡å— - æä¾›æ ¸å¿ƒåŠŸèƒ½å’ŒåŸºç¡€æœåŠ¡</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hguserauditmodule')">
                        <h4>HGUserAuditModule</h4>
                        <p>ç”¨æˆ·å®¡è®¡æ¨¡å— - ç”¨æˆ·æƒé™ç®¡ç†å’Œæ“ä½œæ—¥å¿—</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hglogmodule')">
                        <h4>HGLogModule</h4>
                        <p>æ—¥å¿—æ¨¡å— - ç³»ç»Ÿæ—¥å¿—è®°å½•å’Œç®¡ç†</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgloginmodule')">
                        <h4>HGLoginModule</h4>
                        <p>ç™»å½•æ¨¡å— - ç”¨æˆ·è®¤è¯å’Œä¼šè¯ç®¡ç†</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgsearchmodule')">
                        <h4>HGSearchModule</h4>
                        <p>æœç´¢æ¨¡å— - æ•°æ®æ£€ç´¢å’ŒæŸ¥è¯¢åŠŸèƒ½</p>
                    </li>
                </ul>
            </div>

            <!-- åŠŸèƒ½æ¨¡å— -->
            <div class="module-category">
                <h3>åŠŸèƒ½æ¨¡å— (Functional Modules)</h3>
                <ul class="module-list">
                    <li class="module-item" onclick="showModuleDetails('hgchannelmodule')">
                        <h4>HGChannelModule</h4>
                        <p>é€šé“æ¨¡å— - å¤šé€šé“æ•°æ®é‡‡é›†å’Œæ§åˆ¶</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgcurvemodule')">
                        <h4>HGCurveModule</h4>
                        <p>æ›²çº¿æ¨¡å— - æ•°æ®æ›²çº¿ç»˜åˆ¶å’Œåˆ†æ</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgflowmodule')">
                        <h4>HGFlowModule</h4>
                        <p>æµç¨‹æ¨¡å— - å·¥ä½œæµç¨‹ç®¡ç†å’Œæ§åˆ¶</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgmethodmodule')">
                        <h4>HGMethodModule</h4>
                        <p>æ–¹æ³•æ¨¡å— - å®éªŒæ–¹æ³•é…ç½®å’Œæ‰§è¡Œ</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgreagentmodule')">
                        <h4>HGReagentModule</h4>
                        <p>è¯•å‰‚æ¨¡å— - è¯•å‰‚ç®¡ç†å’Œåº“å­˜æ§åˆ¶</p>
                    </li>
                </ul>
            </div>

            <!-- æœåŠ¡æ¨¡å— -->
            <div class="module-category">
                <h3>æœåŠ¡æ¨¡å— (Service Modules)</h3>
                <ul class="module-list">
                    <li class="module-item" onclick="showModuleDetails('hgcommon')">
                        <h4>HGCommon</h4>
                        <p>é€šç”¨æœåŠ¡ - æä¾›å…¬å…±å·¥å…·å’ŒåŸºç¡€ç»„ä»¶</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgconfig')">
                        <h4>HGConfig</h4>
                        <p>é…ç½®æœåŠ¡ - ç³»ç»Ÿé…ç½®ç®¡ç†å’ŒæŒä¹…åŒ–</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hghardware')">
                        <h4>HGHardware</h4>
                        <p>ç¡¬ä»¶æœåŠ¡ - ç¡¬ä»¶è®¾å¤‡é©±åŠ¨å’Œæ§åˆ¶</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgimageservice')">
                        <h4>HGImageAlgorithmService</h4>
                        <p>å›¾åƒç®—æ³•æœåŠ¡ - å›¾åƒå¤„ç†å’Œè¯†åˆ«ç®—æ³•</p>
                    </li>
                    <li class="module-item" onclick="showModuleDetails('hgcommunicateservice')">
                        <h4>HGCommunicateService</h4>
                        <p>é€šä¿¡æœåŠ¡ - ç½‘ç»œé€šä¿¡å’Œæ•°æ®ä¼ è¾“</p>
                    </li>
                </ul>
            </div>
        </div>

        <!-- æ¨¡å—è¯¦æƒ…åŒºåŸŸ -->
        <div id="moduleDetails" class="module-details">
            <div class="details-header">
                <h3 id="detailTitle">æ¨¡å—è¯¦æƒ…</h3>
                <button class="close-btn" onclick="hideModuleDetails()">å…³é—­</button>
            </div>
            <div class="details-content">
                <div class="dependencies">
                    <h4>ä¾èµ–å…³ç³»</h4>
                    <ul id="dependencyList" class="dependency-list">
                        <!-- åŠ¨æ€å¡«å…… -->
                    </ul>
                </div>
                <div class="features">
                    <h4>ä¸»è¦åŠŸèƒ½</h4>
                    <ul id="featureList" class="feature-list">
                        <!-- åŠ¨æ€å¡«å…… -->
                    </ul>
                </div>
            </div>
            <div class="compile-controls" id="compileControls" style="display: none;">
                <h4>ğŸ”§ ç¼–è¯‘æ§åˆ¶</h4>
                <div class="compile-options">
                    <label>
                        <input type="radio" name="buildType" value="Release" checked> Release
                    </label>
                    <label>
                        <input type="radio" name="buildType" value="Debug"> Debug
                    </label>
                    <label>
                        <input type="checkbox" id="cleanBuild"> æ¸…ç†æ„å»º
                    </label>
                </div>
                <div class="compile-buttons">
                    <button id="compileBtn" class="compile-btn" onclick="startCompile()">å¼€å§‹ç¼–è¯‘</button>
                    <button id="stopBtn" class="stop-btn" onclick="stopCompile()" disabled>åœæ­¢ç¼–è¯‘</button>
                    <button id="packageBtn" class="compile-btn" onclick="packageModule()" disabled>æ‰“åŒ…ç¨‹åº</button>
                </div>
                <div class="compile-output">
                    <h5>ç¼–è¯‘è¾“å‡º</h5>
                    <pre id="compileOutput">ç­‰å¾…ç¼–è¯‘å¼€å§‹...</pre>
                </div>
            </div>
        </div>

        <div class="build-info">
            <h2>ğŸ”§ æ„å»ºå’Œéƒ¨ç½²</h2>
            <div class="build-commands">
                <div class="command-item">
                    <h4>ç¼–è¯‘é¡¹ç›®</h4>
                    <p>ä½¿ç”¨æ ¹ç›®å½•ä¸‹çš„build.batè¿›è¡Œç¼–è¯‘ï¼š</p>
                    <code>./build.bat</code>
                </div>
                <div class="command-item">
                    <h4>è¿è¡Œç¨‹åº</h4>
                    <p>ç¼–è¯‘å®Œæˆåè¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ï¼š</p>
                    <code>./build/software-editor.exe</code>
                </div>
                <div class="command-item">
                    <h4>æµ‹è¯•è„šæœ¬</h4>
                    <p>UIè‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬ä½ç½®ï¼š</p>
                    <code>./test/ui_automation</code>
                </div>
                <div class="command-item">
                    <h4>æ¨¡å—åŒ–ç¼–è¯‘</h4>
                    <p>æ”¯æŒå•ä¸ªæ¨¡å—çš„ç‹¬ç«‹ç¼–è¯‘å’Œæµ‹è¯•</p>
                    <code>./build_module.sh [æ¨¡å—å]</code>
                </div>
            </div>
        </div>
    </div>

    <script>
        const moduleData = {
            'hgdashboardapp': {
                name: 'HGDashboardApp - ä»ªè¡¨ç›˜åº”ç”¨',
                dependencies: ['Qt5 Charts', 'Qt5 Widgets', 'HGCommon', 'HGConfig'],
                features: ['å®æ—¶æ•°æ®ç›‘æ§', 'å›¾è¡¨å¯è§†åŒ–', 'æŠ¥è­¦ç®¡ç†', 'ç³»ç»ŸçŠ¶æ€æ˜¾ç¤º']
            },
            'hgcomdebugapp': {
                name: 'HGComDebugApp - é€šä¿¡è°ƒè¯•åº”ç”¨',
                dependencies: ['Qt5 SerialPort', 'HGUartModule', 'HGCommon'],
                features: ['ä¸²å£é€šä¿¡è°ƒè¯•', 'æ•°æ®åŒ…åˆ†æ', 'åè®®æµ‹è¯•', 'æ—¥å¿—è®°å½•']
            },
            'hgcupdetapp': {
                name: 'HGCupDetApp - æ¯æ£€æµ‹åº”ç”¨',
                dependencies: ['OpenCV', 'HGImageAlgorithmService', 'HGCameraRecognizeModule'],
                features: ['å›¾åƒè¯†åˆ«', 'æ¯ä½ç½®æ£€æµ‹', 'æ ·å“è¯†åˆ«', 'è´¨é‡æ§åˆ¶']
            },
            'hgonlineplatformapp': {
                name: 'HGOnlinePlatformApp - åœ¨çº¿å¹³å°åº”ç”¨',
                dependencies: ['MQTT', 'WebSocket', 'HGCommunicateService', 'HGSecurityService'],
                features: ['äº‘ç«¯æ•°æ®åŒæ­¥', 'è¿œç¨‹ç›‘æ§', 'æ•°æ®å¤‡ä»½', 'å¤šè®¾å¤‡ç®¡ç†']
            },
            'productflow': {
                name: 'ProductFlow - äº§å“æµç¨‹åº”ç”¨',
                dependencies: ['HGFlowModule', 'HGMethodModule', 'HGTaskModule'],
                features: ['æµç¨‹æ§åˆ¶', 'ç”Ÿäº§è°ƒåº¦', 'è´¨é‡æ§åˆ¶', 'æŠ¥è¡¨ç”Ÿæˆ']
            },
            'hgbaseappmodule': {
                name: 'HGBaseAppModule - åŸºç¡€åº”ç”¨æ¨¡å—',
                dependencies: ['Qt5 Core', 'Qt5 Gui', 'HGCommon', 'PluginInterface'],
                features: ['åŸºç¡€UIæ¡†æ¶', 'æ’ä»¶ç®¡ç†', 'äº‹ä»¶å¤„ç†', 'èµ„æºç®¡ç†']
            },
            'hguserauditmodule': {
                name: 'HGUserAuditModule - ç”¨æˆ·å®¡è®¡æ¨¡å—',
                dependencies: ['HGAuthorityService', 'HGSecurityService', 'SQLCipher'],
                features: ['ç”¨æˆ·æƒé™ç®¡ç†', 'æ“ä½œæ—¥å¿—è®°å½•', 'å®‰å…¨å®¡è®¡', 'æ•°æ®åŠ å¯†']
            },
            'hglogmodule': {
                name: 'HGLogModule - æ—¥å¿—æ¨¡å—',
                dependencies: ['log4cplus', 'HGCommon', 'HGSaveService'],
                features: ['ç³»ç»Ÿæ—¥å¿—è®°å½•', 'æ—¥å¿—åˆ†çº§', 'æ—¥å¿—æŸ¥è¯¢', 'æ—¥å¿—å¯¼å‡º']
            },
            'hgloginmodule': {
                name: 'HGLoginModule - ç™»å½•æ¨¡å—',
                dependencies: ['HGAuthorityService', 'HGSecurityService', 'HGConfig'],
                features: ['ç”¨æˆ·è®¤è¯', 'ä¼šè¯ç®¡ç†', 'å¯†ç åŠ å¯†', 'æƒé™éªŒè¯']
            },
            'hgsearchmodule': {
                name: 'HGSearchModule - æœç´¢æ¨¡å—',
                dependencies: ['HGCommon', 'HGSaveService', 'SQLCipher'],
                features: ['æ•°æ®æ£€ç´¢', 'å…¨æ–‡æœç´¢', 'è¿‡æ»¤æŸ¥è¯¢', 'ç»“æœæ’åº']
            },
            'hgchannelmodule': {
                name: 'HGChannelModule - é€šé“æ¨¡å—',
                dependencies: ['HGLowerPC', 'HGSensor', 'HGCommon'],
                features: ['å¤šé€šé“æ•°æ®é‡‡é›†', 'å®æ—¶æ§åˆ¶', 'é€šé“é…ç½®', 'çŠ¶æ€ç›‘æ§']
            },
            'hgcurvemodule': {
                name: 'HGCurveModule - æ›²çº¿æ¨¡å—',
                dependencies: ['Qt5 Charts', 'HGCommon', 'HGSaveService'],
                features: ['æ›²çº¿ç»˜åˆ¶', 'æ•°æ®åˆ†æ', 'æ›²çº¿æ‹Ÿåˆ', 'å¯¼å‡ºåŠŸèƒ½']
            },
            'hgflowmodule': {
                name: 'HGFlowModule - æµç¨‹æ¨¡å—',
                dependencies: ['HGMethodModule', 'HGTaskModule', 'HGCommon'],
                features: ['æµç¨‹å®šä¹‰', 'æ­¥éª¤æ§åˆ¶', 'æ¡ä»¶åˆ¤æ–­', 'æµç¨‹ç›‘æ§']
            },
            'hgmethodmodule': {
                name: 'HGMethodModule - æ–¹æ³•æ¨¡å—',
                dependencies: ['HGReagentModule', 'HGChannelModule', 'HGCommon'],
                features: ['æ–¹æ³•é…ç½®', 'å‚æ•°è®¾ç½®', 'æ‰§è¡Œæ§åˆ¶', 'ç»“æœåˆ†æ']
            },
            'hgreagentmodule': {
                name: 'HGReagentModule - è¯•å‰‚æ¨¡å—',
                dependencies: ['HGCommon', 'HGSaveService', 'SQLCipher'],
                features: ['è¯•å‰‚ç®¡ç†', 'åº“å­˜ç›‘æ§', 'æœ‰æ•ˆæœŸæé†’', 'ä½¿ç”¨è®°å½•']
            },
            'hgcommon': {
                name: 'HGCommon - é€šç”¨æœåŠ¡',
                dependencies: ['STL', 'Boost', 'Threads'],
                features: ['å·¥å…·å‡½æ•°', 'æ•°æ®ç»“æ„', 'çº¿ç¨‹ç®¡ç†', 'å¼‚å¸¸å¤„ç†']
            },
            'hgconfig': {
                name: 'HGConfig - é…ç½®æœåŠ¡',
                dependencies: ['JSON', 'XML', 'SQLCipher'],
                features: ['é…ç½®ç®¡ç†', 'å‚æ•°æŒä¹…åŒ–', 'é…ç½®éªŒè¯', 'å¤šç¯å¢ƒæ”¯æŒ']
            },
            'hghardware': {
                name: 'HGHardware - ç¡¬ä»¶æœåŠ¡',
                dependencies: ['HGLowerPC', 'HGSensor', 'libusb'],
                features: ['è®¾å¤‡é©±åŠ¨', 'ç¡¬ä»¶æ§åˆ¶', 'çŠ¶æ€ç›‘æ§', 'æ•…éšœè¯Šæ–­']
            },
            'hgimageservice': {
                name: 'HGImageAlgorithmService - å›¾åƒç®—æ³•æœåŠ¡',
                dependencies: ['OpenCV', 'ZXing', 'FFmpeg'],
                features: ['å›¾åƒå¤„ç†', 'ç‰¹å¾æå–', 'æ¨¡å¼è¯†åˆ«', 'äºŒç»´ç è¯†åˆ«']
            },
            'hgcommunicateservice': {
                name: 'HGCommunicateService - é€šä¿¡æœåŠ¡',
                dependencies: ['MQTT', 'WebSocket', 'libssh', 'OpenSSL'],
                features: ['ç½‘ç»œé€šä¿¡', 'åè®®å°è£…', 'æ•°æ®åŠ å¯†', 'è¿æ¥ç®¡ç†']
            }
        };

        // å½“å‰é€‰ä¸­çš„æ¨¡å—ID
        let currentModuleId = null;
        // ç¼–è¯‘çŠ¶æ€è½®è¯¢å®šæ—¶å™¨
        let compilePollingInterval = null;
        // æ¨¡å—è¯¦æƒ…æ˜¾ç¤ºçš„é˜²æŠ–å®šæ—¶å™¨
        let showModuleDebounceTimer = null;

        function showModuleDetails(moduleId) {
            // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
            if (showModuleDebounceTimer) {
                clearTimeout(showModuleDebounceTimer);
            }

            // è®¾ç½®é˜²æŠ–å®šæ—¶å™¨ï¼Œ100æ¯«ç§’åæ‰§è¡Œ
            showModuleDebounceTimer = setTimeout(() => {
                const module = moduleData[moduleId];
                if (!module) return;

                currentModuleId = moduleId;
                document.getElementById('detailTitle').textContent = module.name;
                
                // å¡«å……ä¾èµ–å…³ç³»
                const depList = document.getElementById('dependencyList');
                depList.innerHTML = '';
                module.dependencies.forEach(dep => {
                    const li = document.createElement('li');
                    li.textContent = dep;
                    depList.appendChild(li);
                });

                // å¡«å……åŠŸèƒ½åˆ—è¡¨
                const featureList = document.getElementById('featureList');
                featureList.innerHTML = '';
                module.features.forEach(feature => {
                    const li = document.createElement('li');
                    li.textContent = feature;
                    featureList.appendChild(li);
                });

                // æ˜¾ç¤ºç¼–è¯‘æ§åˆ¶åŒºåŸŸï¼ˆä»…å¯¹HGAppModuleç›¸å…³æ¨¡å—æ˜¾ç¤ºï¼‰
                const compileControls = document.getElementById('compileControls');
                const hgAppModules = ['hgbaseappmodule', 'hguserauditmodule', 'hglogmodule', 'hgloginmodule', 'hgsearchmodule'];
                if (hgAppModules.includes(moduleId)) {
                    compileControls.style.display = 'block';
                    resetCompileUI();
                } else {
                    compileControls.style.display = 'none';
                }

                // æ˜¾ç¤ºè¯¦æƒ…åŒºåŸŸ
                document.getElementById('moduleDetails').classList.add('active');
            }, 100);
        }

        function hideModuleDetails() {
            document.getElementById('moduleDetails').classList.remove('active');
        }

        // ç‚¹å‡»é¡µé¢å…¶ä»–åŒºåŸŸå…³é—­è¯¦æƒ…
        document.addEventListener('click', function(event) {
            const details = document.getElementById('moduleDetails');
            if (details.classList.contains('active') && 
                !details.contains(event.target) &&
                !event.target.classList.contains('module-item')) {
                hideModuleDetails();
            }
        });

        // ç¼–è¯‘æ§åˆ¶ç›¸å…³å‡½æ•°
        function resetCompileUI() {
            document.getElementById('compileBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('packageBtn').disabled = true;
            document.getElementById('compileOutput').textContent = 'ç­‰å¾…ç¼–è¯‘å¼€å§‹...';
        }

        function enablePackageBtn() {
            document.getElementById('packageBtn').disabled = false;
        }

        function startCompile() {
            if (!currentModuleId) return;

            const buildType = document.querySelector('input[name="buildType"]:checked').value;
            const cleanBuild = document.getElementById('cleanBuild').checked;

            // ç¦ç”¨å¼€å§‹æŒ‰é’®å’Œæ‰“åŒ…æŒ‰é’®ï¼Œå¯ç”¨åœæ­¢æŒ‰é’®
            document.getElementById('compileBtn').disabled = true;
            document.getElementById('stopBtn').disabled = false;
            document.getElementById('packageBtn').disabled = true;
            document.getElementById('compileOutput').textContent = 'æ­£åœ¨å¯åŠ¨ç¼–è¯‘...';

            // å‘é€ç¼–è¯‘è¯·æ±‚
            fetch('/api/compile/start', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    module: getModuleRealName(currentModuleId),
                    build_type: buildType,
                    clean_build: cleanBuild
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    document.getElementById('compileOutput').textContent = 'ç¼–è¯‘å¯åŠ¨å¤±è´¥: ' + data.error;
                    resetCompileUI();
                } else {
                    document.getElementById('compileOutput').textContent = 'ç¼–è¯‘å·²å¯åŠ¨ï¼Œæ­£åœ¨ç­‰å¾…è¾“å‡º...';
                    // å¼€å§‹è½®è¯¢ç¼–è¯‘çŠ¶æ€
                    startCompilePolling();
                }
            })
            .catch(error => {
                document.getElementById('compileOutput').textContent = 'è¯·æ±‚å¤±è´¥: ' + error.message;
                resetCompileUI();
            });
        }

        function stopCompile() {
            fetch('/api/compile/stop', {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('compileOutput').textContent += '\nç¼–è¯‘å·²åœæ­¢';
                } else {
                    document.getElementById('compileOutput').textContent += '\nåœæ­¢ç¼–è¯‘å¤±è´¥: ' + data.message;
                }
                resetCompileUI();
                if (compilePollingInterval) {
                    clearInterval(compilePollingInterval);
                    compilePollingInterval = null;
                }
            })
            .catch(error => {
                document.getElementById('compileOutput').textContent += '\nåœæ­¢è¯·æ±‚å¤±è´¥: ' + error.message;
                resetCompileUI();
            });
        }

        function startCompilePolling() {
            let consecutiveErrorCount = 0;
            const maxConsecutiveErrors = 3;

            compilePollingInterval = setInterval(() => {
                fetch('/api/compile/status')
                    .then(response => response.json())
                    .then(data => {
                        consecutiveErrorCount = 0; // é‡ç½®é”™è¯¯è®¡æ•°
                        const outputElement = document.getElementById('compileOutput');
                        
                        if (data.is_running) {
                            outputElement.textContent = data.last_output || 'æ­£åœ¨ç¼–è¯‘ä¸­...';
                            // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
                            outputElement.scrollTop = outputElement.scrollHeight;
                        } else {
                            // ç¼–è¯‘åœæ­¢ï¼Œä½†éœ€è¦æ£€æŸ¥æ˜¯å¦æœ‰è¾“å‡ºå†…å®¹
                            if (data.last_output && data.last_output.length > 0) {
                                outputElement.textContent = data.last_output;
                                // æ£€æŸ¥ç¼–è¯‘æ˜¯å¦æˆåŠŸ
                                const outputText = outputElement.textContent.toLowerCase();
                                if (outputText.includes('ç¼–è¯‘æˆåŠŸ') || outputText.includes('success')) {
                                    outputElement.textContent += '\nâœ… ç¼–è¯‘æˆåŠŸï¼';
                                    enablePackageBtn(); // ç¼–è¯‘æˆåŠŸåå¯ç”¨æ‰“åŒ…æŒ‰é’®
                                } else {
                                    outputElement.textContent += '\nâŒ ç¼–è¯‘å¤±è´¥ï¼';
                                }
                            } else {
                                outputElement.textContent = 'ç¼–è¯‘å·²åœæ­¢ï¼Œä½†æ²¡æœ‰è¾“å‡ºå†…å®¹';
                            }
                            
                            // å»¶è¿Ÿé‡ç½®UIï¼Œè®©ç”¨æˆ·æœ‰æ—¶é—´çœ‹åˆ°æœ€ç»ˆç»“æœå’Œä¸­é—´æ–‡ä»¶ä½ç½®
                            setTimeout(() => {
                                resetCompileUI();
                            }, 8000);
                            
                            if (compilePollingInterval) {
                                clearInterval(compilePollingInterval);
                                compilePollingInterval = null;
                            }
                        }
                    })
                    .catch(error => {
                        console.error('è½®è¯¢å¤±è´¥:', error);
                        consecutiveErrorCount++;
                        
                        // å¦‚æœè¿ç»­é”™è¯¯è¶…è¿‡æœ€å¤§å€¼ï¼Œåœæ­¢è½®è¯¢
                        if (consecutiveErrorCount >= maxConsecutiveErrors) {
                            const outputElement = document.getElementById('compileOutput');
                            outputElement.textContent += '\nâš ï¸ ç¼–è¯‘çŠ¶æ€è½®è¯¢å¤±è´¥ï¼Œå¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜æˆ–æœåŠ¡å™¨é”™è¯¯';
                            
                            // å»¶è¿Ÿé‡ç½®UI
                            setTimeout(() => {
                                resetCompileUI();
                            }, 3000);
                            
                            if (compilePollingInterval) {
                                clearInterval(compilePollingInterval);
                                compilePollingInterval = null;
                            }
                        }
                    });
            }, 1000);
        }

        function packageModule() {
            if (!currentModuleId) return;

            const buildType = document.querySelector('input[name="buildType"]:checked').value;

            document.getElementById('compileOutput').textContent += '\n\nå¼€å§‹æ‰“åŒ…ç¨‹åº...';
            document.getElementById('packageBtn').disabled = true;

            // å‘é€æ‰“åŒ…è¯·æ±‚
            fetch('/api/compile/package', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    module: getModuleRealName(currentModuleId),
                    build_type: buildType
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    document.getElementById('compileOutput').textContent += '\nâŒ æ‰“åŒ…å¤±è´¥: ' + data.error;
                } else {
                    document.getElementById('compileOutput').textContent += '\nâœ… æ‰“åŒ…æˆåŠŸï¼' + data.message;
                }
                document.getElementById('packageBtn').disabled = false;
            })
            .catch(error => {
                document.getElementById('compileOutput').textContent += '\nâŒ æ‰“åŒ…è¯·æ±‚å¤±è´¥: ' + error.message;
                document.getElementById('packageBtn').disabled = false;
            });
        }

        function getModuleRealName(moduleId) {
            const moduleMap = {
                'hgbaseappmodule': 'HGBaseAppModule',
                'hguserauditmodule': 'HGUserAuditModule',
                'hglogmodule': 'HGLogModule',
                'hgloginmodule': 'HGLoginModule',
                'hgsearchmodule': 'HGSearchModule'
            };
            return moduleMap[moduleId] || moduleId;
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–ç¼–è¯‘UI
        document.addEventListener('DOMContentLoaded', function() {
            resetCompileUI();
        });
    </script>
</body>
</html>